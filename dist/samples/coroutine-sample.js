"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var immutable_1 = require("immutable");
var lib_1 = require("../lib");
console.log(' --- coroutine sample');
var safeGetVar = function (k) {
    return lib_1.Coroutine(function (m0) {
        if (m0.has(k)) {
            console.log('safeGetVar', k, m0.get(k));
            return lib_1.coStepResult(m0, m0.get(k));
        }
        else {
            console.error('safeGetVar error:', k);
            return lib_1.coStepError("not found");
        }
    });
};
var setVar = function (k, value) {
    console.log('setVar', k, value);
    return lib_1.Coroutine(function (m0) { return lib_1.coStepResult(m0.set(k, value), {}); });
};
var forceGetVar = function (k, fallbackValue) {
    console.log('forcegetVar', k, fallbackValue);
    return lib_1.tryCatch(safeGetVar(k), function (_) { return lib_1.Coroutine(function (m0) {
        console.error('forcegetVar error');
        return lib_1.coStepResult(m0.set(k, fallbackValue), fallbackValue);
    }); });
};
var myCoroutine = lib_1.unitCo()({})
    .bind(function (_) { return setVar('x', 23)
    .bind(function (_) { return setVar('y', 999)
    .bind(function (_) { return lib_1.suspend()
    .bind(function (_) { return safeGetVar('x')
    .bind(function (_) { return forceGetVar('q', 12890); }); }); }); }); });
exports.myCoroutineResult = function () {
    myCoroutine.fun.f(immutable_1.Map());
    console.log(exports.myCoroutineResult);
    return {};
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29yb3V0aW5lLXNhbXBsZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NhbXBsZXMvY29yb3V0aW5lLXNhbXBsZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHVDQUFxQztBQUdyQyw4QkFBK0Y7QUFFL0YsT0FBTyxDQUFDLEdBQUcsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFBO0FBT3BDLElBQU0sVUFBVSxHQUFHLFVBQUMsQ0FBVTtJQUM1QixPQUFBLGVBQVMsQ0FBRSxVQUFDLEVBQVM7UUFDbkIsSUFBSSxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFO1lBQ2IsT0FBTyxDQUFDLEdBQUcsQ0FBQyxZQUFZLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQTtZQUN2QyxPQUFPLGtCQUFZLENBQXdCLEVBQUUsRUFBRSxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBVyxDQUFDLENBQUE7U0FDcEU7YUFBTTtZQUNMLE9BQU8sQ0FBQyxLQUFLLENBQUMsbUJBQW1CLEVBQUUsQ0FBQyxDQUFDLENBQUE7WUFDckMsT0FBTyxpQkFBVyxDQUF3QixXQUFXLENBQUMsQ0FBQTtTQUN2RDtJQUNILENBQUMsQ0FBQztBQVJGLENBUUUsQ0FBQTtBQUVKLElBQU0sTUFBTSxHQUFHLFVBQUMsQ0FBUyxFQUFFLEtBQWE7SUFDdEMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFBO0lBQy9CLE9BQU8sZUFBUyxDQUFFLFVBQUMsRUFBUyxJQUFLLE9BQUEsa0JBQVksQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsRUFBRSxFQUFFLENBQUMsRUFBbEMsQ0FBa0MsQ0FBQyxDQUFBO0FBQ3RFLENBQUMsQ0FBQTtBQUVELElBQU0sV0FBVyxHQUFHLFVBQUMsQ0FBUyxFQUFFLGFBQXNCO0lBQ3BELE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFFLENBQUMsRUFBRSxhQUFhLENBQUMsQ0FBQTtJQUM1QyxPQUFPLGNBQVEsQ0FDYixVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQ2IsVUFBQyxDQUFPLElBQUssT0FBQSxlQUFTLENBQUUsVUFBQyxFQUFVO1FBQ2pDLE9BQU8sQ0FBQyxLQUFLLENBQUMsbUJBQW1CLENBQUMsQ0FBQTtRQUNsQyxPQUFPLGtCQUFZLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsYUFBYSxDQUFDLEVBQUUsYUFBYSxDQUFDLENBQUE7SUFDOUQsQ0FBQyxDQUFDLEVBSFcsQ0FHWCxDQUNILENBQUE7QUFDSCxDQUFDLENBQUE7QUFFRCxJQUFNLFdBQVcsR0FDZixZQUFNLEVBQWdCLENBQU8sRUFBRSxDQUFDO0tBQzdCLElBQUksQ0FBQyxVQUFDLENBQU0sSUFBSyxPQUFBLE1BQU0sQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDO0tBQzlCLElBQUksQ0FBQyxVQUFDLENBQU0sSUFBSyxPQUFBLE1BQU0sQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDO0tBQy9CLElBQUksQ0FBQyxVQUFDLENBQU0sSUFBSyxPQUFBLGFBQU8sRUFBZ0I7S0FDdEMsSUFBSSxDQUFDLFVBQUMsQ0FBTSxJQUFLLE9BQUEsVUFBVSxDQUFDLEdBQUcsQ0FBQztLQUM5QixJQUFJLENBQUMsVUFBQyxDQUFRLElBQUssT0FBQSxXQUFXLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxFQUF2QixDQUF1QixDQUFDLEVBRDVCLENBQzRCLENBQzdDLEVBSGUsQ0FHZixDQUNGLEVBTGUsQ0FLZixDQUNGLEVBUGUsQ0FPZixDQUNGLENBQUE7QUFFUSxRQUFBLGlCQUFpQixHQUFHO0lBQy9CLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLGVBQUcsRUFBRSxDQUFDLENBQUE7SUFDeEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyx5QkFBaUIsQ0FBQyxDQUFBO0lBQzlCLE9BQU8sRUFBRSxDQUFBO0FBQ1gsQ0FBQyxDQUFBIn0=